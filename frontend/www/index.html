<!DOCTYPE html>
<html>

<!-- <div id="like_button_container"></div>
 -->


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

<link rel = "stylesheet" href = "css.css" >


<head>
  <title>Google Signin</title>
  <meta name="google-signin-client_id" content="943622887340-2qaen0te8c0q2of6pk9k4u691kpd52te.apps.googleusercontent.com">
  <script src="https://apis.google.com/js/platform.js" asynch defer></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script> 
    var profile;
    function onSignIn(googleUser){
      profile=googleUser.getBasicProfile;
      $(".g-signin2").css("display","none");
      $(".data").css("display","block");
    }
    function signOut(){
      var auth2 = gapi.auth2.getAuthInstance();
      auth2.signOut().then(function(){
        alert("You've been successfully signed out");
        $(".g-signin2").css("display","block");
        $(".data").css("display","none");
      })

    }
  </script>
  
  <style>
    .g-signin2{
      margin-left:500px;
      margin-top:200px;
    }
    .data{
      display:none;
    }
  </style>
</head>
<body>
  <div class="g-signin2" data-onsuccess="onSignIn"></div>
  <div class="data">
    <button onclick="signOut()" class="btn btn-danger">SignOut</button>
  </div>
</body>





<img src= "images/logo.png">


<button type="button" class="btn btn-success" onclick="location.href ='postpage.html'">POST</button>


<button type="button" class="btn btn-danger">SUBSCRIBE</button>
<button type="button" class="btn btn-warning">UNSUSCRIBE</button>
<button type="button" class="btn btn-info">LOGIN</button>

<br>
<br>


<div id="blogPost"></div>

<script> 

	function createCORSRequest(method, url) {
  		var xhr = new XMLHttpRequest();
	  if ("withCredentials" in xhr) {

	    // Check if the XMLHttpRequest object has a "withCredentials" property.
	    // "withCredentials" only exists on XMLHTTPRequest2 objects.
	    xhr.open(method, url, true);

	  } else if (typeof XDomainRequest != "undefined") {

	    // Otherwise, check if XDomainRequest.
	    // XDomainRequest only exists in IE, and is IE's way of making CORS requests.
	    xhr = new XDomainRequest();
	    xhr.open(method, url);

	  } else {

	    // Otherwise, CORS is not supported by the browser.
	    xhr = null;

	  }
	  return xhr;
	}

	url = "https://t-collective-268505.appspot.com/blogposts"
	const xhr = createCORSRequest('GET',url);
	const blog_post = document.getElementById("blogPost");
	xhr.open('GET', url, true)
	xhr.onload = function(){
		if (this.status == 200){
			subPosts = xhr.responseText.split('</p>');
			innerHtml = "";
			for( i = 0; i<subPosts.length && i < 5; i++){
				innerHtml= innerHtml +' </p> '+subPosts[i];
			}
			var num = subPosts.length;
			blog_post.innerHTML=innerHtml;//innerHtml+'</p>';
		}
		else{

			console.warn("Lets assume this works")
		}
	}
	xhr.send();
	
function morePosts()  {
	for(j = 5 ; j < subPosts.length-1; j++){
		innerHtml = innerHtml +' </p> '+ subPosts[j];
	}
	blog_post.innerHTML=innerHtml;
	var x = document.getElementById("read btn");
	x.style.display = "none";

//xhr.send();
}

</script>

<button type="button" class="btn btn-link" id = "read btn" onclick="morePosts()">Read All Posts</button>

</body>

</html>
